{% load humanize %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NobleStudio- Photography Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="icon" href="{% static 'images/log.png' %}" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Raleway:wght@300;400;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'playfair': ['"Playfair Display"', 'serif'],
                        'raleway': ['Raleway', 'sans-serif'],
                    },
                    colors: {
                        'photo-dark': '#1a1a1a',
                        'photo-light': '#f8f8f8',
                        'photo-gold': '#d4af37',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .discount-overlay {
            animation: fadeIn 0.3s ease-in-out;
        }
        .discount-content {
            animation: slideDown 0.5s ease-out;
        }
    </style>
</head>
<body class="bg-photo-light font-raleway text-photo-dark">
    
    {% if discount %}
    <!-- Full Screen Discount Overlay -->
    <div id="discountOverlay" class="discount-overlay fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div class="discount-content bg-gradient-to-br from-yellow-400 via-yellow-500 to-yellow-600 rounded-3xl shadow-2xl max-w-4xl w-full relative overflow-hidden">
            <!-- Close Button -->
            <button onclick="closeDiscount()" class="absolute top-6 right-6 text-white hover:text-gray-200 transition-colors z-10">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>

            <!-- Decorative Elements -->
            <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full -mr-32 -mt-32"></div>
            <div class="absolute bottom-0 left-0 w-96 h-96 bg-white opacity-10 rounded-full -ml-48 -mb-48"></div>

            <!-- Content -->
            <div class="relative z-10 p-8 md:p-16 text-center">
                <!-- Icon/Badge -->
                <div class="mb-6">
                    <div class="inline-flex items-center justify-center w-24 h-24 bg-white rounded-full shadow-lg">
                        <span class="text-6xl">üéâ</span>
                    </div>
                </div>

                <!-- Title -->
                <h2 class="text-4xl md:text-6xl font-playfair font-bold text-white mb-4">
                    Diskon Spesial!
                </h2>

                <!-- Discount Value -->
                <div class="mb-6">
                    {% if discount.discount_type == 'percent' %}
                        <div class="inline-block bg-white text-yellow-600 px-8 py-4 rounded-2xl shadow-xl">
                            <p class="text-6xl md:text-8xl font-bold">{{ discount.discount_value }}%</p>
                            <p class="text-xl md:text-2xl font-semibold">OFF</p>
                        </div>
                    {% else %}
                        <div class="inline-block bg-white text-yellow-600 px-8 py-4 rounded-2xl shadow-xl">
                            <p class="text-2xl md:text-3xl font-semibold">Potongan</p>
                            <p class="text-5xl md:text-7xl font-bold">Rp {{ discount.discount_value|intcomma }}</p>
                        </div>
                    {% endif %}
                </div>

                <!-- Description -->
                {% if discount.description %}
                <p class="text-xl md:text-2xl text-white mb-8 max-w-2xl mx-auto font-medium">
                    {{ discount.description }}
                </p>
                {% else %}
                <p class="text-xl md:text-2xl text-white mb-8 max-w-2xl mx-auto font-medium">
                    Untuk Semua Layanan Fotografi
                </p>
                {% endif %}

                <!-- Call to Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <a href="{% url 'booking' %}" 
                       class="bg-white text-yellow-600 px-10 py-4 rounded-full text-xl font-bold hover:bg-gray-100 transition-all transform hover:scale-105 shadow-xl">
                        Gunakan Sekarang ‚Üí
                    </a>
                    <button onclick="closeDiscount()" 
                            class="text-white border-2 border-white px-10 py-4 rounded-full text-xl font-semibold hover:bg-white hover:text-yellow-600 transition-all">
                        Nanti Saja
                    </button>
                </div>

                <!-- Limited Time Notice -->
                <p class="text-white text-sm md:text-base mt-6 opacity-90">
                    ‚è∞ Berakhir dalam:
                </p>

                <p id="countdownTimer" 
                class="text-white text-xl md:text-2xl font-bold mt-2">
                Loading...
                </p>

            </div>
        </div>
    </div>

    <script>
        const expiredAt = new Date("{{ discount.expired_at|date:'Y-m-d H:i:s' }}").getTime();

        const countdownInterval = setInterval(function () {
            const now = new Date().getTime();
            const distance = expiredAt - now;

            if (distance <= 0) {
                clearInterval(countdownInterval);
                document.getElementById("countdownTimer").innerHTML = "‚ùå Diskon telah berakhir";
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById("countdownTimer").innerHTML =
                `${days} hari ${hours} jam ${minutes} menit ${seconds} detik`;
        }, 1000);

        function closeDiscount() {
            const overlay = document.getElementById('discountOverlay');
            overlay.style.animation = 'fadeOut 0.3s ease-in-out';
            setTimeout(() => {
                overlay.style.display = 'none';
            }, 300);
        }

        // Optional: Close on ESC key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeDiscount();
            }
        });

        // Optional: Close when clicking outside the modal
        document.getElementById('discountOverlay').addEventListener('click', function(event) {
            if (event.target === this) {
                closeDiscount();
            }
        });
    </script>
    {% endif %}

    <!-- Navigation -->
    <nav class="bg-white/80 backdrop-blur-md fixed w-full z-10 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">

                <!-- Logo / Greeting -->
                <div class="flex flex-col">
                    {% if user.is_authenticated %}
                        <h3 class="text-xl font-semibold text-gray-800">
                            Halo, <span class="text-photo-gold">{{ user.first_name }} {{ user.last_name }}</span> 
                        </h3>
                        <p class="text-gray-500 text-sm">{{ user.email }}</p>
                    {% else %}
                        <p class="text-gray-800">
                            Selamat datang di <span class="font-bold text-photo-gold">NobleStudio</span>
                        </p>
                    {% endif %}
                </div>

                <!-- Menu (Desktop) -->
                <div class="hidden md:flex items-center space-x-6 ml-auto">
                    <a href="/" class="text-photo-dark hover:text-photo-gold transition">Beranda</a>
                    <a href="#portfolio" class="text-photo-dark hover:text-photo-gold transition">Portfolio</a>
                    <a href="#about" class="text-photo-dark hover:text-photo-gold transition">Tentang Saya</a>
                    <a href="#services" class="text-photo-dark hover:text-photo-gold transition">Layanan</a>
                    <a href="schedule" class="text-photo-dark hover:text-photo-gold transition">Lihat Jadwal</a>
                    <a href="#contact" class="bg-photo-gold text-white px-4 py-2 rounded hover:bg-opacity-90 transition">
                        Kontak
                    </a>

                    <!-- üîî Ikon Notifikasi -->
                    <div class="fixed top-5 right-5 z-50">
                        <button id="notifBtn" class="relative bg-transparent border-none cursor-pointer transition-transform duration-200 hover:scale-110">
                            <span id="bellIcon" class="text-3xl inline-block transition-transform duration-200">üîî</span>
                            {% if approved_bookings %}
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full text-xs px-1.5 py-0.5 min-w-[20px] text-center">
                                {{ approved_bookings|length }}
                            </span>
                            {% endif %}
                        </button>
                        
                        <!-- Popup -->
                        <div id="notifPopup" class="absolute right-0 top-9 w-80 bg-white border border-gray-300 rounded-xl shadow-xl p-4 opacity-0 -translate-y-2 pointer-events-none transition-all duration-300">
                            <h4 class="text-lg font-semibold text-gray-800 m-0">Jadwal Yang Telah Disetujui</h4>
                            <hr class="my-3 border-gray-200">
                            
                            {% if approved_bookings %}
                            <ul class="list-none p-0 m-0 max-h-96 overflow-y-auto">
                                {% for booking in approved_bookings %}
                                <li class="mb-4 pb-4 border-b border-gray-100 last:border-b-0">
                                    <strong class="text-gray-800 text-sm">{{ booking.service|title }}</strong>
                                    <p class="text-gray-600 text-sm mt-1 mb-2">{{ booking.date }} - {{ booking.time }}</p>
                                    <p class="text-xs text-green-600 mb-2">Status: ‚úÖ {{ booking.approved }}</p>
                                    <a href="{% url 'booking_detail' booking.id %}" 
                                    class="inline-block text-white bg-blue-500 hover:bg-blue-600 px-3 py-1.5 rounded-md text-xs transition-colors duration-200">
                                        Detail
                                    </a>
                                </li>
                                {% endfor %}
                            </ul>
                            {% else %}
                            <p class="text-gray-500 text-sm text-center py-4">Tidak ada notifikasi saat ini.</p>
                            {% endif %}
                        </div>
                    </div>

                    {% if user.is_authenticated %}
                        <a href="{% url 'account_logout' %}" 
                           class="text-black bg-transparent hover:bg-red-600 hover:text-white px-4 py-2 rounded-lg transition">
                            Logout
                        </a>
                    {% else %}
                        <a href="{% url 'login' %}" 
                              class="text-black bg-transparent hover:bg-black hover:text-white px-4 py-2 rounded-lg transition">
                            Login
                        </a>
                    {% endif %}
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center">
                    <button id="mobileMenuButton" class="mobile-menu-button">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                  d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>

            </div>

            <!-- Mobile Menu (Hidden by default) -->
            <div id="mobileMenu" class="md:hidden hidden bg-white/95 backdrop-blur-md border-t border-gray-200">
                <div class="px-4 py-3 space-y-3">
                    <a href="/" class="block text-photo-dark hover:text-photo-gold transition py-2">Beranda</a>
                    <a href="#portfolio" class="block text-photo-dark hover:text-photo-gold transition py-2">Portfolio</a>
                    <a href="#about" class="block text-photo-dark hover:text-photo-gold transition py-2">Tentang Saya</a>
                    <a href="#services" class="block text-photo-dark hover:text-photo-gold transition py-2">Layanan</a>
                    <a href="schedule" class="block text-photo-dark hover:text-photo-gold transition py-2">Lihat Jadwal</a>
                    <a href="#contact" class="block bg-photo-gold text-white px-4 py-2 rounded hover:bg-opacity-90 transition text-center">
                        Kontak
                    </a>

                    {% if user.is_authenticated %}
                        <a href="{% url 'account_logout' %}" 
                           class="block text-black bg-transparent hover:bg-red-600 hover:text-white px-4 py-2 rounded-lg transition text-center border border-red-600">
                            Logout
                        </a>
                    {% else %}
                        <a href="{% url 'login' %}"  
                              class="block text-black bg-transparent hover:bg-black hover:text-white px-4 py-2 rounded-lg transition text-center border border-black">
                            Login
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="pt-24 pb-16 md:pt-32 md:pb-24 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        <div class="grid md:grid-cols-2 gap-12 items-center">
            <div>
                <h1 class="text-4xl md:text-5xl lg:text-6xl font-playfair font-bold mb-6">Capturing Life's <span class="text-photo-gold">Beautiful</span> Moments</h1>
                <p class="text-lg mb-8 text-gray-600">Layanan fotografi profesional yang mengkhususkan diri dalam potret, pernikahan, dan pekerjaan komersial. Berkantor pusat di Kudus.</p>
                <div class="flex space-x-4">
                    <a href="#portfolio" class="bg-photo-gold text-white px-6 py-3 rounded hover:bg-opacity-90 transition">Tampilkan Portfolio</a>
                {% if user.is_authenticated %}
                    <a href="{% url 'booking' %}" 
                    class="px-6 py-3 rounded-lg border border-photo-dark text-photo-dark hover:bg-photo-dark hover:text-white">
                        Jadwalkan Sesi
                    </a>
                {% else %}
                    <button onclick="loginWarning()"
                        class="px-6 py-3 rounded-lg border border-photo-dark text-photo-dark hover:bg-photo-dark hover:text-white">
                        Jadwalkan Sesi
                    </button>
                {% endif %}

                </div>
            </div>
            <div class="relative">
                <div class="relative aspect-square overflow-hidden rounded-lg shadow-xl">
                    <img 
                        src="https://images.unsplash.com/photo-1516035069371-29a1b244cc32?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" 
                        alt="Unsplash photo" 
                        class="w-full h-full object-cover">
                </div>

                <div class="absolute -bottom-6 -right-6 bg-white p-4 shadow-lg rounded-lg hidden md:block">
                    <p class="font-bold text-photo-gold">5+ Tahun Pengalaman</p>
                    <p class="text-sm text-gray-500">Fotografi Profesional</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Portfolio Section -->
    <section id="portfolio" class="py-16 bg-photo-dark text-white px-4 sm:px-6 lg:px-8">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-playfair font-bold mb-4">Portfolio</h2>
                <p class="max-w-2xl mx-auto text-gray-300">Jelajahi karya terbaru saya di berbagai genre fotografi</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="group relative overflow-hidden rounded-lg aspect-square">
                    <img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Portrait photography" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold text-xl">Portraits</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-lg aspect-square">
                    <img src="https://images.unsplash.com/photo-1523438885200-e635ba2c371e?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Wedding photography" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold text-xl">Weddings</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-lg aspect-square">
                    <img src="https://images.unsplash.com/photo-1462826303086-329426d1aef5?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Commercial photography" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold text-xl">Commercial</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-lg aspect-square">
                    <img src="https://images.unsplash.com/photo-1519671482749-fd09be7ccebf?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Fashion photography" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold text-xl">Fashion</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-lg aspect-square">
                    <img src="https://images.unsplash.com/photo-1516035069371-29a1b244cc32?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Travel photography" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold text-xl">Travel</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-lg aspect-square">
                    <img src="https://images.unsplash.com/photo-1493863641943-9b68992a8d07?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Event photography" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                        <span class="text-white font-bold text-xl">Events</span>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-8">
                <a href="/myporto" class="inline-block border border-white text-white px-6 py-3 rounded hover:bg-white hover:text-photo-dark transition">View Full Portfolio</a>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-16 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        <div class="grid md:grid-cols-2 gap-12 items-center">
            <div class="order-2 md:order-1">
                <h2 class="text-3xl md:text-4xl font-playfair font-bold mb-6">Tentang Saya</h2>
                <p class="text-lg mb-4">Berawal dari rasa ingin tahu yang besar terhadap dunia fotografi sejak tahun 2006, saya memulai perjalanan ini secara autodidak ‚Äî belajar dari berbagai sumber dan aktif mengikuti seminar-seminar fotografi.</p>
                <p class="mb-6 text-gray-600">Setelah enam tahun mendalami dan mengasah kemampuan, saya akhirnya memberanikan diri untuk mendirikan vendor fotografi sendiri pada tahun 2012. Sejak saat itu, saya terus berkomitmen untuk menangkap setiap momen berharga dengan sentuhan profesional dan penuh rasa.</p>
                
                <div class="grid grid-cols-2 gap-4 mb-8">
                    <div class="border-l-2 border-photo-gold pl-4">
                        <p class="font-bold text-2xl">500+</p>
                        <p class="text-gray-500">Clients</p>
                    </div>
                    <div class="border-l-2 border-photo-gold pl-4">
                        <p class="font-bold text-2xl">100+</p>
                        <p class="text-gray-500">Events</p>
                    </div>
                    <div class="border-l-2 border-photo-gold pl-4">
                        <p class="font-bold text-2xl">1</p>
                        <p class="text-gray-500">Countries</p>
                    </div>
                    <div class="border-l-2 border-photo-gold pl-4">
                        <p class="font-bold text-2xl">50+</p>
                        <p class="text-gray-500">Exhibitions</p>
                    </div>
                </div>
                
                <a href="#contact" class="bg-photo-gold text-white px-6 py-3 rounded hover:bg-opacity-90 transition">Get in Touch</a>
            </div>
            <div class="order-1 md:order-2">
                <div class="relative aspect-square overflow-hidden rounded-lg shadow-xl">
                    <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Photographer portrait" class="w-full h-full object-cover">
                </div>
            </div>
        </div>
    </section>

</body>
</html>